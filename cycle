Option Explicit
Option Base 1
                                                'Option base çíà÷èò ÷òî íà÷íåì íå ñ 0, à ñ 1
Sub nn()
    Dim count As Long, i As Long                'ïðèñâàèâàåì ïåðåìåííûì òèï äàííûõ- ÷èñëîâîé
    i = 2                                       'ïî÷åìó i=2 ïîòîìó íóìåðàöèÿ ñòðîê íà÷èíàåòñÿ ñ 1
    Do While Upload.Cells(i, 10) <> ""          'íà÷àëî öèêëà, ñ÷èòàåì êîë-âî ñòðîê äëÿ ìàññèâà ñ ÿ÷åéêè ñ i ñòðîêè è 10 ñòîëáöà
        If Upload.Cells(i, 10) = "ST010" Then     'åñëè äàííûå âî âêëàäêå Upload â i ñòðîêå è 10 ñòîëáöå ðàâåí ÑÒ10, òî
            count = count + 1                     'óâåëè÷èâàåì êîë-âî íàéäåííûõ ñòðîê â áóä.ìàññèâå
        End If                                    'êîíåö óñëîâèÿ
        i = i + 1                                 'ïåðåõîä íà ñëåäóþùóþ ñòðîêó
    Loop                                        'êîíåö öèêëà
    Dim massive() As Variant                    'ïðèñâàèâàåì ïåðåìåííîé â âèäå ìàññèâà òèï äàííûõ ëþáîé
    ReDim massive(count, 4)                     'reDim(ñìîòðåòü ãóãë) ïåðåîïðåäåëÿåì, äàåì ðàçìåðíîñòü ìàññèâó Ïåðâûé àðãóìåíò îïðåäåëÿåò êîëè÷åñòâî ñòðîê, âòîðîé — ñòîëáöîâ.
    Dim j As Long                               'ïðèñâàèâàåì ìàññèâó òèï äàííûõ- ÷èñëîâîé
    j = 1                                           'j - ýòî ñòðîêè ìàññèâà â áóôåð(îïåðàòèâêó)
    i = 2                                       'ïåðåìåííàÿ ¹ ñòðîê â ÿ÷åéêàõ
    Do While Upload.Cells(i, 10) <> ""          'íà÷àëî âòîðîãî öèêëà
        If Upload.Cells(i, 10) = "ST010" Then   'åñëè äàííûå â áóôåðå îáìåíà â i ñòðîêå è 10 ñòîëáöå ðàâåí ÑÒ10, òî
            massive(j, 1) = Upload.Cells(i, 1)  'ïðè âûïîëåíèè óñëîâèÿ - âñòàâêà â ñòðîêó j è 1ûé ñòîëáåö äàííûå èç âêëàäêè Upload ñîãëàñíî àäðåñó
            massive(j, 2) = Upload.Cells(i, 4)
            massive(j, 3) = "×àñòíîå ëèöî"
            massive(j, 4) = Upload.Cells(i, 8)
            
            j = j + 1                           'ïåðåõîä íà ñëåäóþùóþ ñòðîêó âî âêëàäêå Çàÿâêà
        End If                                  'êîíåö ÓÑËÎÂÈß
        i = i + 1                               'ïåðåõîä íà ñëåä ñòðîêó âî âêëàäêå Upload äëÿ êîïèðîâàíèÿ
        
    Loop                                            'êîíåö öèêëà
    Request1.Cells(2, 1).Resize(count, 4) = massive 'âñòàâêà öåëåâûå ÿ÷åéêè çàïîëíÿþòñÿ çíà÷åíèÿìè ìàññèâà. Request1 - ëèñò, îáüåêò. Resize -ìû óâåëè÷èëè ÿ÷åéêó äî ðàçìåðîâ j ñòðîê è 4õ ñòîëáöîâ
    Dim a                                           'Òî÷êà îñòàíîâà äëÿ äåáàãà. Brake point
    a = 5
End Sub
